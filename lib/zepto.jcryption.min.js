(function(r){r.jCryption=function(i,e){var t=this;t.$el=r(i);t.el=i;t.$el.data("jCryption",t);t.$el.data("salt",null);t.$el.data("key",null);t.init=function(){t.options=r.extend({},r.jCryption.defaultOptions,e);t.$el.bind("mousemove",function(r){if(t.$el.data("salt")===null){t.$el.data("salt",(r.pageX+r.pageY)*Math.random())}else{t.$el.unbind("mousemove")}});$encryptedElement=r("<input />",{type:"hidden",name:t.options.postVariable});if(t.options.submitElement!==false){var i=t.options.submitElement}else{var i=t.$el.find(":input:submit")}i.bind(t.options.submitEvent,function(){r(this).attr("disabled",true);if(t.options.beforeEncryption()){t.authenticate(function(e){var n=t.$el.serialize();if(i.is(":submit")){n=n+"&"+i.attr("name")+"="+i.val()}$encryptedElement.val(r.jCryption.encrypt(n,e));r(t.$el).find(t.options.formFieldSelector).attr("disabled",true).end().append($encryptedElement).submit()},function(){r(t.$el).submit()})}return false})};t.init();t.getKey=function(){if(t.$el.data("key")!==null){return t.$el.data("key")}var r=t.$el.data("salt");if(r===null){r=Math.floor(Math.random()*Math.random())}var i=new jsSHA(r.toString(),"ASCII");t.$el.data("key",i.getHash("SHA-512","HEX"));return t.getKey()};t.authenticate=function(i,e){var n=t.getKey();r.jCryption.authenticate(n,t.options.getKeysURL,t.options.handshakeURL,i,e)}};r.jCryption.authenticate=function(i,e,t,n,a){r.jCryption.getKeys(e,function(e){r.jCryption.encryptKey(i,e,function(e){r.jCryption.handshake(t,e,function(e){if(r.jCryption.challenge(e.challenge,i)){n.call(this,i)}else{a.call(this)}})})})};r.jCryption.getKeys=function(i,e){var t=function(r,i,e){setMaxDigits(parseInt(e,10));this.e=biFromHex(r);this.m=biFromHex(i);this.chunkSize=2*biHighIndex(this.m);this.radix=16;this.barrett=new BarrettMu(this.m)};r.getJSON(i,function(i){var n=new t(i.e,i.n,i.maxdigits);if(r.isFunction(e)){e.call(this,n)}})};r.jCryption.decrypt=function(r,i){return Aes.Ctr.decrypt(r,i,256)};r.jCryption.encrypt=function(r,i){return Aes.Ctr.encrypt(r,i,256)};r.jCryption.challenge=function(i,e){if(r.jCryption.decrypt(i,e)==e){return true}return false};r.jCryption.handshake=function(i,e,t){r.ajax({url:i,dataType:"json",type:"POST",data:{key:e},success:function(r){t.call(this,r)}})};r.jCryption.encryptKey=function(i,e,t){var n=0;for(var a=0;a<i.length;a++){n+=i.charCodeAt(a)}var o="0123456789abcdef";var s="";s+=o.charAt((n&240)>>4)+o.charAt(n&15);var d=s+i;var h=[];var g=0;while(g<d.length){h[g]=d.charCodeAt(g);g++}while(h.length%e.chunkSize!==0){h[g++]=0}function u(i){var n=0;var a,o;var s="";function d(){o=new BigInt;a=0;for(var h=n;h<n+e.chunkSize;++a){o.digits[a]=i[h++];o.digits[a]+=i[h++]<<8}var g=e.barrett.powMod(o,e.e);var u=e.radix==16?biToHex(g):biToString(g,e.radix);s+=u+" ";n+=e.chunkSize;if(n<i.length){setTimeout(d,1)}else{var l=s.substring(0,s.length-1);if(r.isFunction(t)){t(l)}else{return l}}}setTimeout(d,1)}u(h)};r.jCryption.defaultOptions={submitElement:false,submitEvent:"click",getKeysURL:"main.php?generateKeypair=true",handshakeURL:"main.php?handshake=true",beforeEncryption:function(){return true},postVariable:"jCryption",formFieldSelector:":input"};r.fn.jCryption=function(i){return this.each(function(){new r.jCryption(this,i)})}})(window.jQuery||window.Zepto);var biRadixBase=2;var biRadixBits=16;var bitsPerDigit=biRadixBits;var biRadix=1<<16;var biHalfRadix=biRadix>>>1;var biRadixSquared=biRadix*biRadix;var maxDigitVal=biRadix-1;var maxInteger=9999999999999998;var maxDigits;var ZERO_ARRAY;var bigZero,bigOne;var dpl10=15;var highBitMasks=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535);var hexatrigesimalToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z");var hexToChar=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var lowBitMasks=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);function setMaxDigits(r){maxDigits=r;ZERO_ARRAY=new Array(maxDigits);for(var i=0;i<ZERO_ARRAY.length;i++)ZERO_ARRAY[i]=0;bigZero=new BigInt;bigOne=new BigInt;bigOne.digits[0]=1}function BigInt(r){if(typeof r=="boolean"&&r==true){this.digits=null}else{this.digits=ZERO_ARRAY.slice(0)}this.isNeg=false}function biFromDecimal(r){var i=r.charAt(0)=="-";var e=i?1:0;var t;while(e<r.length&&r.charAt(e)=="0")++e;if(e==r.length){t=new BigInt}else{var n=r.length-e;var a=n%dpl10;if(a==0)a=dpl10;t=biFromNumber(Number(r.substr(e,a)));e+=a;while(e<r.length){t=biAdd(biMultiply(t,biFromNumber(1e15)),biFromNumber(Number(r.substr(e,dpl10))));e+=dpl10}t.isNeg=i}return t}function biCopy(r){var i=new BigInt(true);i.digits=r.digits.slice(0);i.isNeg=r.isNeg;return i}function biFromNumber(r){var i=new BigInt;i.isNeg=r<0;r=Math.abs(r);var e=0;while(r>0){i.digits[e++]=r&maxDigitVal;r>>=biRadixBits}return i}function reverseStr(r){var i="";for(var e=r.length-1;e>-1;--e){i+=r.charAt(e)}return i}function biToString(r,i){var e=new BigInt;e.digits[0]=i;var t=biDivideModulo(r,e);var n=hexatrigesimalToChar[t[1].digits[0]];while(biCompare(t[0],bigZero)==1){t=biDivideModulo(t[0],e);digit=t[1].digits[0];n+=hexatrigesimalToChar[t[1].digits[0]]}return(r.isNeg?"-":"")+reverseStr(n)}function biToDecimal(r){var i=new BigInt;i.digits[0]=10;var e=biDivideModulo(r,i);var t=String(e[1].digits[0]);while(biCompare(e[0],bigZero)==1){e=biDivideModulo(e[0],i);t+=String(e[1].digits[0])}return(r.isNeg?"-":"")+reverseStr(t)}function digitToHex(r){var e=15;var t="";for(i=0;i<4;++i){t+=hexToChar[r&e];r>>>=4}return reverseStr(t)}function biToHex(r){var i="";var e=biHighIndex(r);for(var t=biHighIndex(r);t>-1;--t){i+=digitToHex(r.digits[t])}return i}function charToHex(r){var i=48;var e=i+9;var t=97;var n=t+25;var a=65;var o=65+25;var s;if(r>=i&&r<=e){s=r-i}else if(r>=a&&r<=o){s=10+r-a}else if(r>=t&&r<=n){s=10+r-t}else{s=0}return s}function hexToDigit(r){var i=0;var e=Math.min(r.length,4);for(var t=0;t<e;++t){i<<=4;i|=charToHex(r.charCodeAt(t))}return i}function biFromHex(r){var i=new BigInt;var e=r.length;for(var t=e,n=0;t>0;t-=4,++n){i.digits[n]=hexToDigit(r.substr(Math.max(t-4,0),Math.min(t,4)))}return i}function biFromString(r,i){var e=r.charAt(0)=="-";var t=e?1:0;var n=new BigInt;var a=new BigInt;a.digits[0]=1;for(var o=r.length-1;o>=t;o--){var s=r.charCodeAt(o);var d=charToHex(s);var h=biMultiplyDigit(a,d);n=biAdd(n,h);a=biMultiplyDigit(a,i)}n.isNeg=e;return n}function biDump(r){return(r.isNeg?"-":"")+r.digits.join(" ")}function biAdd(r,i){var e;if(r.isNeg!=i.isNeg){i.isNeg=!i.isNeg;e=biSubtract(r,i);i.isNeg=!i.isNeg}else{e=new BigInt;var t=0;var n;for(var a=0;a<r.digits.length;++a){n=r.digits[a]+i.digits[a]+t;e.digits[a]=n&65535;t=Number(n>=biRadix)}e.isNeg=r.isNeg}return e}function biSubtract(r,i){var e;if(r.isNeg!=i.isNeg){i.isNeg=!i.isNeg;e=biAdd(r,i);i.isNeg=!i.isNeg}else{e=new BigInt;var t,n;n=0;for(var a=0;a<r.digits.length;++a){t=r.digits[a]-i.digits[a]+n;e.digits[a]=t&65535;if(e.digits[a]<0)e.digits[a]+=biRadix;n=0-Number(t<0)}if(n==-1){n=0;for(var a=0;a<r.digits.length;++a){t=0-e.digits[a]+n;e.digits[a]=t&65535;if(e.digits[a]<0)e.digits[a]+=biRadix;n=0-Number(t<0)}e.isNeg=!r.isNeg}else{e.isNeg=r.isNeg}}return e}function biHighIndex(r){var i=r.digits.length-1;while(i>0&&r.digits[i]==0)--i;return i}function biNumBits(r){var i=biHighIndex(r);var e=r.digits[i];var t=(i+1)*bitsPerDigit;var n;for(n=t;n>t-bitsPerDigit;--n){if((e&32768)!=0)break;e<<=1}return n}function biMultiply(r,i){var e=new BigInt;var t;var n=biHighIndex(r);var a=biHighIndex(i);var o,s,d;for(var h=0;h<=a;++h){t=0;d=h;for(j=0;j<=n;++j,++d){s=e.digits[d]+r.digits[j]*i.digits[h]+t;e.digits[d]=s&maxDigitVal;t=s>>>biRadixBits}e.digits[h+n+1]=t}e.isNeg=r.isNeg!=i.isNeg;return e}function biMultiplyDigit(r,i){var e,t,n;var a=new BigInt;e=biHighIndex(r);t=0;for(var o=0;o<=e;++o){n=a.digits[o]+r.digits[o]*i+t;a.digits[o]=n&maxDigitVal;t=n>>>biRadixBits}a.digits[1+e]=t;return a}function arrayCopy(r,i,e,t,n){var a=Math.min(i+n,r.length);for(var o=i,s=t;o<a;++o,++s){e[s]=r[o]}}function biShiftLeft(r,i){var e=Math.floor(i/bitsPerDigit);var t=new BigInt;arrayCopy(r.digits,0,t.digits,e,t.digits.length-e);var n=i%bitsPerDigit;var a=bitsPerDigit-n;for(var o=t.digits.length-1,s=o-1;o>0;--o,--s){t.digits[o]=t.digits[o]<<n&maxDigitVal|(t.digits[s]&highBitMasks[n])>>>a}t.digits[0]=t.digits[o]<<n&maxDigitVal;t.isNeg=r.isNeg;return t}function biShiftRight(r,i){var e=Math.floor(i/bitsPerDigit);var t=new BigInt;arrayCopy(r.digits,e,t.digits,0,r.digits.length-e);var n=i%bitsPerDigit;var a=bitsPerDigit-n;for(var o=0,s=o+1;o<t.digits.length-1;++o,++s){t.digits[o]=t.digits[o]>>>n|(t.digits[s]&lowBitMasks[n])<<a}t.digits[t.digits.length-1]>>>=n;t.isNeg=r.isNeg;return t}function biMultiplyByRadixPower(r,i){var e=new BigInt;arrayCopy(r.digits,0,e.digits,i,e.digits.length-i);return e}function biDivideByRadixPower(r,i){var e=new BigInt;arrayCopy(r.digits,i,e.digits,0,e.digits.length-i);return e}function biModuloByRadixPower(r,i){var e=new BigInt;arrayCopy(r.digits,0,e.digits,0,i);return e}function biCompare(r,i){if(r.isNeg!=i.isNeg){return 1-2*Number(r.isNeg)}for(var e=r.digits.length-1;e>=0;--e){if(r.digits[e]!=i.digits[e]){if(r.isNeg){return 1-2*Number(r.digits[e]>i.digits[e])}else{return 1-2*Number(r.digits[e]<i.digits[e])}}}return 0}function biDivideModulo(r,i){var e=biNumBits(r);var t=biNumBits(i);var n=i.isNeg;var a,o;if(e<t){if(r.isNeg){a=biCopy(bigOne);a.isNeg=!i.isNeg;r.isNeg=false;i.isNeg=false;o=biSubtract(i,r);r.isNeg=true;i.isNeg=n}else{a=new BigInt;o=biCopy(r)}return new Array(a,o)}a=new BigInt;o=r;var s=Math.ceil(t/bitsPerDigit)-1;var d=0;while(i.digits[s]<biHalfRadix){i=biShiftLeft(i,1);++d;++t;s=Math.ceil(t/bitsPerDigit)-1}o=biShiftLeft(o,d);e+=d;var h=Math.ceil(e/bitsPerDigit)-1;var g=biMultiplyByRadixPower(i,h-s);while(biCompare(o,g)!=-1){++a.digits[h-s];o=biSubtract(o,g)}for(var u=h;u>s;--u){var l=u>=o.digits.length?0:o.digits[u];var f=u-1>=o.digits.length?0:o.digits[u-1];var c=u-2>=o.digits.length?0:o.digits[u-2];var v=s>=i.digits.length?0:i.digits[s];var w=s-1>=i.digits.length?0:i.digits[s-1];if(l==v){a.digits[u-s-1]=maxDigitVal}else{a.digits[u-s-1]=Math.floor((l*biRadix+f)/v)}var b=a.digits[u-s-1]*(v*biRadix+w);var A=l*biRadixSquared+(f*biRadix+c);while(b>A){--a.digits[u-s-1];b=a.digits[u-s-1]*(v*biRadix|w);A=l*biRadix*biRadix+(f*biRadix+c)}g=biMultiplyByRadixPower(i,u-s-1);o=biSubtract(o,biMultiplyDigit(g,a.digits[u-s-1]));if(o.isNeg){o=biAdd(o,g);--a.digits[u-s-1]}}o=biShiftRight(o,d);a.isNeg=r.isNeg!=n;if(r.isNeg){if(n){a=biAdd(a,bigOne)}else{a=biSubtract(a,bigOne)}i=biShiftRight(i,d);o=biSubtract(i,o)}if(o.digits[0]==0&&biHighIndex(o)==0)o.isNeg=false;return new Array(a,o)}function biDivide(r,i){return biDivideModulo(r,i)[0]}function biModulo(r,i){return biDivideModulo(r,i)[1]}function biMultiplyMod(r,i,e){return biModulo(biMultiply(r,i),e)}function biPow(r,i){var e=bigOne;var t=r;while(true){if((i&1)!=0)e=biMultiply(e,t);i>>=1;if(i==0)break;t=biMultiply(t,t)}return e}function biPowMod(r,i,e){var t=bigOne;var n=r;var a=i;while(true){if((a.digits[0]&1)!=0)t=biMultiplyMod(t,n,e);a=biShiftRight(a,1);if(a.digits[0]==0&&biHighIndex(a)==0)break;n=biMultiplyMod(n,n,e)}return t}function BarrettMu(r){this.modulus=biCopy(r);this.k=biHighIndex(this.modulus)+1;var i=new BigInt;i.digits[2*this.k]=1;this.mu=biDivide(i,this.modulus);this.bkplus1=new BigInt;this.bkplus1.digits[this.k+1]=1;this.modulo=BarrettMu_modulo;this.multiplyMod=BarrettMu_multiplyMod;this.powMod=BarrettMu_powMod}function BarrettMu_modulo(r){var i=biDivideByRadixPower(r,this.k-1);var e=biMultiply(i,this.mu);var t=biDivideByRadixPower(e,this.k+1);var n=biModuloByRadixPower(r,this.k+1);var a=biMultiply(t,this.modulus);var o=biModuloByRadixPower(a,this.k+1);var s=biSubtract(n,o);if(s.isNeg){s=biAdd(s,this.bkplus1)}var d=biCompare(s,this.modulus)>=0;while(d){s=biSubtract(s,this.modulus);d=biCompare(s,this.modulus)>=0}return s}function BarrettMu_multiplyMod(r,i){var e=biMultiply(r,i);return this.modulo(e)}function BarrettMu_powMod(r,i){var e=new BigInt;e.digits[0]=1;while(true){if((i.digits[0]&1)!=0)e=this.multiplyMod(e,r);i=biShiftRight(i,1);if(i.digits[0]==0&&biHighIndex(i)==0)break;r=this.multiplyMod(r,r)}return e}var Aes={};Aes.cipher=function(r,i){var e=4;var t=i.length/e-1;var n=[[],[],[],[]];for(var a=0;a<4*e;a++)n[a%4][Math.floor(a/4)]=r[a];n=Aes.addRoundKey(n,i,0,e);for(var o=1;o<t;o++){n=Aes.subBytes(n,e);n=Aes.shiftRows(n,e);n=Aes.mixColumns(n,e);n=Aes.addRoundKey(n,i,o,e)}n=Aes.subBytes(n,e);n=Aes.shiftRows(n,e);n=Aes.addRoundKey(n,i,t,e);var s=new Array(4*e);for(var a=0;a<4*e;a++)s[a]=n[a%4][Math.floor(a/4)];return s};Aes.keyExpansion=function(r){var i=4;var e=r.length/4;var t=e+6;var n=new Array(i*(t+1));var a=new Array(4);for(var o=0;o<e;o++){var s=[r[4*o],r[4*o+1],r[4*o+2],r[4*o+3]];n[o]=s}for(var o=e;o<i*(t+1);o++){n[o]=new Array(4);for(var d=0;d<4;d++)a[d]=n[o-1][d];if(o%e==0){a=Aes.subWord(Aes.rotWord(a));for(var d=0;d<4;d++)a[d]^=Aes.rCon[o/e][d]}else if(e>6&&o%e==4){a=Aes.subWord(a)}for(var d=0;d<4;d++)n[o][d]=n[o-e][d]^a[d]}return n};Aes.subBytes=function(r,i){for(var e=0;e<4;e++){for(var t=0;t<i;t++)r[e][t]=Aes.sBox[r[e][t]]}return r};Aes.shiftRows=function(r,i){var e=new Array(4);for(var t=1;t<4;t++){for(var n=0;n<4;n++)e[n]=r[t][(n+t)%i];for(var n=0;n<4;n++)r[t][n]=e[n]}return r};Aes.mixColumns=function(r,i){for(var e=0;e<4;e++){var t=new Array(4);var n=new Array(4);for(var a=0;a<4;a++){t[a]=r[a][e];n[a]=r[a][e]&128?r[a][e]<<1^283:r[a][e]<<1}r[0][e]=n[0]^t[1]^n[1]^t[2]^t[3];r[1][e]=t[0]^n[1]^t[2]^n[2]^t[3];r[2][e]=t[0]^t[1]^n[2]^t[3]^n[3];r[3][e]=t[0]^n[0]^t[1]^t[2]^n[3]}return r};Aes.addRoundKey=function(r,i,e,t){for(var n=0;n<4;n++){for(var a=0;a<t;a++)r[n][a]^=i[e*4+a][n]}return r};Aes.subWord=function(r){for(var i=0;i<4;i++)r[i]=Aes.sBox[r[i]];return r};Aes.rotWord=function(r){var i=r[0];for(var e=0;e<3;e++)r[e]=r[e+1];r[3]=i;return r};Aes.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];Aes.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];Aes.Ctr={};Aes.Ctr.encrypt=function(r,i,e){var t=16;if(!(e==128||e==192||e==256))return"";r=Utf8.encode(r);i=Utf8.encode(i);var n=e/8;var a=new Array(n);for(var o=0;o<n;o++){a[o]=isNaN(i.charCodeAt(o))?0:i.charCodeAt(o)}var s=Aes.cipher(a,Aes.keyExpansion(a));s=s.concat(s.slice(0,n-16));var d=new Array(t);var h=(new Date).getTime();var g=h%1e3;var u=Math.floor(h/1e3);var l=Math.floor(Math.random()*65535);for(var o=0;o<2;o++)d[o]=g>>>o*8&255;for(var o=0;o<2;o++)d[o+2]=l>>>o*8&255;for(var o=0;o<4;o++)d[o+4]=u>>>o*8&255;var f="";for(var o=0;o<8;o++)f+=String.fromCharCode(d[o]);var c=Aes.keyExpansion(s);var v=Math.ceil(r.length/t);var w=new Array(v);for(var b=0;b<v;b++){for(var A=0;A<4;A++)d[15-A]=b>>>A*8&255;for(var A=0;A<4;A++)d[15-A-4]=b/4294967296>>>A*8;var O=Aes.cipher(d,c);var m=b<v-1?t:(r.length-1)%t+1;var y=new Array(m);for(var o=0;o<m;o++){y[o]=O[o]^r.charCodeAt(b*t+o);y[o]=String.fromCharCode(y[o])}w[b]=y.join("")}var p=f+w.join("");p=Base64.encode(p);return p};Aes.Ctr.decrypt=function(r,i,e){var t=16;if(!(e==128||e==192||e==256))return"";r=Base64.decode(r);i=Utf8.encode(i);var n=e/8;var a=new Array(n);for(var o=0;o<n;o++){a[o]=isNaN(i.charCodeAt(o))?0:i.charCodeAt(o)}var s=Aes.cipher(a,Aes.keyExpansion(a));s=s.concat(s.slice(0,n-16));var d=new Array(8);ctrTxt=r.slice(0,8);for(var o=0;o<8;o++)d[o]=ctrTxt.charCodeAt(o);var h=Aes.keyExpansion(s);var g=Math.ceil((r.length-8)/t);var u=new Array(g);for(var l=0;l<g;l++)u[l]=r.slice(8+l*t,8+l*t+t);r=u;var f=new Array(r.length);for(var l=0;l<g;l++){for(var c=0;c<4;c++)d[15-c]=l>>>c*8&255;for(var c=0;c<4;c++)d[15-c-4]=(l+1)/4294967296-1>>>c*8&255;var v=Aes.cipher(d,h);var w=new Array(r[l].length);for(var o=0;o<r[l].length;o++){w[o]=v[o]^r[l].charCodeAt(o);w[o]=String.fromCharCode(w[o])}f[l]=w.join("")}var b=f.join("");b=Utf8.decode(b);return b};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Base64.encode=function(r,i){i=typeof i=="undefined"?false:i;var e,t,n,a,o,s,d,h,g=[],u="",l,f,c;var v=Base64.code;f=i?r.encodeUTF8():r;l=f.length%3;if(l>0){while(l++<3){u+="=";f+="\0"}}for(l=0;l<f.length;l+=3){e=f.charCodeAt(l);t=f.charCodeAt(l+1);n=f.charCodeAt(l+2);a=e<<16|t<<8|n;o=a>>18&63;s=a>>12&63;d=a>>6&63;h=a&63;g[l/3]=v.charAt(o)+v.charAt(s)+v.charAt(d)+v.charAt(h)}c=g.join("");c=c.slice(0,c.length-u.length)+u;return c};Base64.decode=function(r,i){i=typeof i=="undefined"?false:i;var e,t,n,a,o,s,d,h,g=[],u,l;var f=Base64.code;l=i?r.decodeUTF8():r;for(var c=0;c<l.length;c+=4){a=f.indexOf(l.charAt(c));o=f.indexOf(l.charAt(c+1));s=f.indexOf(l.charAt(c+2));d=f.indexOf(l.charAt(c+3));h=a<<18|o<<12|s<<6|d;e=h>>>16&255;t=h>>>8&255;n=h&255;g[c/4]=String.fromCharCode(e,t,n);if(d==64)g[c/4]=String.fromCharCode(e,t);if(s==64)g[c/4]=String.fromCharCode(e)}u=g.join("");return i?u.decodeUTF8():u};var Utf8={};Utf8.encode=function(r){var i=r.replace(/[\u0080-\u07ff]/g,function(r){var i=r.charCodeAt(0);return String.fromCharCode(192|i>>6,128|i&63)});i=i.replace(/[\u0800-\uffff]/g,function(r){var i=r.charCodeAt(0);return String.fromCharCode(224|i>>12,128|i>>6&63,128|i&63)});return i};Utf8.decode=function(r){var i=r.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(r){var i=(r.charCodeAt(0)&15)<<12|(r.charCodeAt(1)&63)<<6|r.charCodeAt(2)&63;return String.fromCharCode(i)});i=i.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(r){var i=(r.charCodeAt(0)&31)<<6|r.charCodeAt(1)&63;return String.fromCharCode(i)});return i};var charSize=8,b64pad="",hexCase=0,Int_64=function(r,i){this.highOrder=r;this.lowOrder=i},str2binb=function(r){var i=[],e=(1<<charSize)-1,t=r.length*charSize,n;for(n=0;n<t;n+=charSize){i[n>>5]|=(r.charCodeAt(n/charSize)&e)<<32-charSize-n%32}return i},hex2binb=function(r){var i=[],e=r.length,t,n;for(t=0;t<e;t+=2){n=parseInt(r.substr(t,2),16);if(!isNaN(n)){i[t>>3]|=n<<24-4*(t%8)}else{return"INVALID HEX STRING"}}return i},binb2hex=function(r){var i=hexCase?"0123456789ABCDEF":"0123456789abcdef",e="",t=r.length*4,n,a;for(n=0;n<t;n+=1){a=r[n>>2]>>(3-n%4)*8;e+=i.charAt(a>>4&15)+i.charAt(a&15)}return e},binb2b64=function(r){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"+"0123456789+/",e="",t=r.length*4,n,a,o;for(n=0;n<t;n+=3){o=(r[n>>2]>>8*(3-n%4)&255)<<16|(r[n+1>>2]>>8*(3-(n+1)%4)&255)<<8|r[n+2>>2]>>8*(3-(n+2)%4)&255;for(a=0;a<4;a+=1){if(n*8+a*6<=r.length*32){e+=i.charAt(o>>6*(3-a)&63)}else{e+=b64pad}}}return e},rotl_32=function(r,i){return r<<i|r>>>32-i},rotr_32=function(r,i){return r>>>i|r<<32-i},rotr_64=function(r,i){if(i<=32){return new Int_64(r.highOrder>>>i|r.lowOrder<<32-i,r.lowOrder>>>i|r.highOrder<<32-i)}else{return new Int_64(r.lowOrder>>>i|r.highOrder<<32-i,r.highOrder>>>i|r.lowOrder<<32-i)}},shr_32=function(r,i){return r>>>i},shr_64=function(r,i){if(i<=32){return new Int_64(r.highOrder>>>i,r.lowOrder>>>i|r.highOrder<<32-i)}else{return new Int_64(0,r.highOrder<<32-i)}},parity_32=function(r,i,e){return r^i^e},ch_32=function(r,i,e){return r&i^~r&e},ch_64=function(r,i,e){return new Int_64(r.highOrder&i.highOrder^~r.highOrder&e.highOrder,r.lowOrder&i.lowOrder^~r.lowOrder&e.lowOrder)},maj_32=function(r,i,e){return r&i^r&e^i&e},maj_64=function(r,i,e){return new Int_64(r.highOrder&i.highOrder^r.highOrder&e.highOrder^i.highOrder&e.highOrder,r.lowOrder&i.lowOrder^r.lowOrder&e.lowOrder^i.lowOrder&e.lowOrder)},sigma0_32=function(r){return rotr_32(r,2)^rotr_32(r,13)^rotr_32(r,22)},sigma0_64=function(r){var i=rotr_64(r,28),e=rotr_64(r,34),t=rotr_64(r,39);return new Int_64(i.highOrder^e.highOrder^t.highOrder,i.lowOrder^e.lowOrder^t.lowOrder)},sigma1_32=function(r){return rotr_32(r,6)^rotr_32(r,11)^rotr_32(r,25)},sigma1_64=function(r){var i=rotr_64(r,14),e=rotr_64(r,18),t=rotr_64(r,41);return new Int_64(i.highOrder^e.highOrder^t.highOrder,i.lowOrder^e.lowOrder^t.lowOrder)},gamma0_32=function(r){return rotr_32(r,7)^rotr_32(r,18)^shr_32(r,3)},gamma0_64=function(r){var i=rotr_64(r,1),e=rotr_64(r,8),t=shr_64(r,7);return new Int_64(i.highOrder^e.highOrder^t.highOrder,i.lowOrder^e.lowOrder^t.lowOrder)},gamma1_32=function(r){return rotr_32(r,17)^rotr_32(r,19)^shr_32(r,10)},gamma1_64=function(r){var i=rotr_64(r,19),e=rotr_64(r,61),t=shr_64(r,6);return new Int_64(i.highOrder^e.highOrder^t.highOrder,i.lowOrder^e.lowOrder^t.lowOrder)},safeAdd_32_2=function(r,i){var e=(r&65535)+(i&65535),t=(r>>>16)+(i>>>16)+(e>>>16);return(t&65535)<<16|e&65535},safeAdd_32_4=function(r,i,e,t){var n=(r&65535)+(i&65535)+(e&65535)+(t&65535),a=(r>>>16)+(i>>>16)+(e>>>16)+(t>>>16)+(n>>>16);return(a&65535)<<16|n&65535},safeAdd_32_5=function(r,i,e,t,n){var a=(r&65535)+(i&65535)+(e&65535)+(t&65535)+(n&65535),o=(r>>>16)+(i>>>16)+(e>>>16)+(t>>>16)+(n>>>16)+(a>>>16);return(o&65535)<<16|a&65535},safeAdd_64_2=function(r,i){var e,t,n,a;e=(r.lowOrder&65535)+(i.lowOrder&65535);t=(r.lowOrder>>>16)+(i.lowOrder>>>16)+(e>>>16);n=(t&65535)<<16|e&65535;e=(r.highOrder&65535)+(i.highOrder&65535)+(t>>>16);t=(r.highOrder>>>16)+(i.highOrder>>>16)+(e>>>16);a=(t&65535)<<16|e&65535;return new Int_64(a,n)},safeAdd_64_4=function(r,i,e,t){var n,a,o,s;n=(r.lowOrder&65535)+(i.lowOrder&65535)+(e.lowOrder&65535)+(t.lowOrder&65535);a=(r.lowOrder>>>16)+(i.lowOrder>>>16)+(e.lowOrder>>>16)+(t.lowOrder>>>16)+(n>>>16);o=(a&65535)<<16|n&65535;n=(r.highOrder&65535)+(i.highOrder&65535)+(e.highOrder&65535)+(t.highOrder&65535)+(a>>>16);a=(r.highOrder>>>16)+(i.highOrder>>>16)+(e.highOrder>>>16)+(t.highOrder>>>16)+(n>>>16);s=(a&65535)<<16|n&65535;return new Int_64(s,o)},safeAdd_64_5=function(r,i,e,t,n){var a,o,s,d;a=(r.lowOrder&65535)+(i.lowOrder&65535)+(e.lowOrder&65535)+(t.lowOrder&65535)+(n.lowOrder&65535);o=(r.lowOrder>>>16)+(i.lowOrder>>>16)+(e.lowOrder>>>16)+(t.lowOrder>>>16)+(n.lowOrder>>>16)+(a>>>16);s=(o&65535)<<16|a&65535;a=(r.highOrder&65535)+(i.highOrder&65535)+(e.highOrder&65535)+(t.highOrder&65535)+(n.highOrder&65535)+(o>>>16);o=(r.highOrder>>>16)+(i.highOrder>>>16)+(e.highOrder>>>16)+(t.highOrder>>>16)+(n.highOrder>>>16)+(a>>>16);d=(o&65535)<<16|a&65535;return new Int_64(d,s)},coreSHA1=function(r,i){var e=[],t,n,a,o,s,d,h=ch_32,g=parity_32,u=maj_32,l=rotl_32,f=safeAdd_32_2,c,v,w=safeAdd_32_5,b,A=[1732584193,4023233417,2562383102,271733878,3285377520],O=[1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782];r[i>>5]|=128<<24-i%32;r[(i+65>>9<<4)+15]=i;b=r.length;for(c=0;c<b;c+=16){t=A[0];n=A[1];a=A[2];o=A[3];s=A[4];for(v=0;v<80;v+=1){if(v<16){e[v]=r[v+c]}else{e[v]=l(e[v-3]^e[v-8]^e[v-14]^e[v-16],1)}if(v<20){d=w(l(t,5),h(n,a,o),s,O[v],e[v])}else if(v<40){d=w(l(t,5),g(n,a,o),s,O[v],e[v])}else if(v<60){d=w(l(t,5),u(n,a,o),s,O[v],e[v])}else{d=w(l(t,5),g(n,a,o),s,O[v],e[v])}s=o;o=a;a=l(n,30);n=t;t=d}A[0]=f(t,A[0]);A[1]=f(n,A[1]);A[2]=f(a,A[2]);A[3]=f(o,A[3]);A[4]=f(s,A[4])}return A},coreSHA2=function(r,i,e){var t,n,a,o,s,d,h,g,u,l,f,c,v,w,b,A,O,m,y,p,_,x,C,S,N,B,M,H,I=[],R;if(e==="SHA-224"||e==="SHA-256"){c=64;v=(i+65>>9<<4)+15;A=16;O=1;M=Number;m=safeAdd_32_2;y=safeAdd_32_4;p=safeAdd_32_5;_=gamma0_32;x=gamma1_32;C=sigma0_32;S=sigma1_32;B=maj_32;N=ch_32;H=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(e==="SHA-224"){f=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}else{f=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]}}else if(e==="SHA-384"||e==="SHA-512"){c=80;v=(i+128>>10<<5)+31;A=32;O=2;M=Int_64;m=safeAdd_64_2;y=safeAdd_64_4;p=safeAdd_64_5;_=gamma0_64;x=gamma1_64;C=sigma0_64;S=sigma1_64;B=maj_64;N=ch_64;H=[new M(1116352408,3609767458),new M(1899447441,602891725),new M(3049323471,3964484399),new M(3921009573,2173295548),new M(961987163,4081628472),new M(1508970993,3053834265),new M(2453635748,2937671579),new M(2870763221,3664609560),new M(3624381080,2734883394),new M(310598401,1164996542),new M(607225278,1323610764),new M(1426881987,3590304994),new M(1925078388,4068182383),new M(2162078206,991336113),new M(2614888103,633803317),new M(3248222580,3479774868),new M(3835390401,2666613458),new M(4022224774,944711139),new M(264347078,2341262773),new M(604807628,2007800933),new M(770255983,1495990901),new M(1249150122,1856431235),new M(1555081692,3175218132),new M(1996064986,2198950837),new M(2554220882,3999719339),new M(2821834349,766784016),new M(2952996808,2566594879),new M(3210313671,3203337956),new M(3336571891,1034457026),new M(3584528711,2466948901),new M(113926993,3758326383),new M(338241895,168717936),new M(666307205,1188179964),new M(773529912,1546045734),new M(1294757372,1522805485),new M(1396182291,2643833823),new M(1695183700,2343527390),new M(1986661051,1014477480),new M(2177026350,1206759142),new M(2456956037,344077627),new M(2730485921,1290863460),new M(2820302411,3158454273),new M(3259730800,3505952657),new M(3345764771,106217008),new M(3516065817,3606008344),new M(3600352804,1432725776),new M(4094571909,1467031594),new M(275423344,851169720),new M(430227734,3100823752),new M(506948616,1363258195),new M(659060556,3750685593),new M(883997877,3785050280),new M(958139571,3318307427),new M(1322822218,3812723403),new M(1537002063,2003034995),new M(1747873779,3602036899),new M(1955562222,1575990012),new M(2024104815,1125592928),new M(2227730452,2716904306),new M(2361852424,442776044),new M(2428436474,593698344),new M(2756734187,3733110249),new M(3204031479,2999351573),new M(3329325298,3815920427),new M(3391569614,3928383900),new M(3515267271,566280711),new M(3940187606,3454069534),new M(4118630271,4000239992),new M(116418474,1914138554),new M(174292421,2731055270),new M(289380356,3203993006),new M(460393269,320620315),new M(685471733,587496836),new M(852142971,1086792851),new M(1017036298,365543100),new M(1126000580,2618297676),new M(1288033470,3409855158),new M(1501505948,4234509866),new M(1607167915,987167468),new M(1816402316,1246189591)];if(e==="SHA-384"){f=[new M(3418070365,3238371032),new M(1654270250,914150663),new M(2438529370,812702999),new M(355462360,4144912697),new M(1731405415,4290775857),new M(41048885895,1750603025),new M(3675008525,1694076839),new M(1203062813,3204075428)]}else{f=[new M(1779033703,4089235720),new M(3144134277,2227873595),new M(1013904242,4271175723),new M(2773480762,1595750129),new M(1359893119,2917565137),new M(2600822924,725511199),new M(528734635,4215389547),new M(1541459225,327033209)]}}r[i>>5]|=128<<24-i%32;r[v]=i;R=r.length;for(w=0;w<R;w+=A){t=f[0];n=f[1];a=f[2];o=f[3];s=f[4];d=f[5];h=f[6];g=f[7];for(b=0;b<c;b+=1){if(b<16){I[b]=new M(r[b*O+w],r[b*O+w+1])}else{I[b]=y(x(I[b-2]),I[b-7],_(I[b-15]),I[b-16])}u=p(g,S(s),N(s,d,h),H[b],I[b]);l=m(C(t),B(t,n,a));g=h;h=d;d=s;s=m(o,u);o=a;a=n;n=t;t=m(u,l)}f[0]=m(t,f[0]);f[1]=m(n,f[1]);f[2]=m(a,f[2]);f[3]=m(o,f[3]);f[4]=m(s,f[4]);f[5]=m(d,f[5]);f[6]=m(h,f[6]);f[7]=m(g,f[7])}switch(e){case"SHA-224":return[f[0],f[1],f[2],f[3],f[4],f[5],f[6]];case"SHA-256":return f;case"SHA-384":return[f[0].highOrder,f[0].lowOrder,f[1].highOrder,f[1].lowOrder,f[2].highOrder,f[2].lowOrder,f[3].highOrder,f[3].lowOrder,f[4].highOrder,f[4].lowOrder,f[5].highOrder,f[5].lowOrder];case"SHA-512":return[f[0].highOrder,f[0].lowOrder,f[1].highOrder,f[1].lowOrder,f[2].highOrder,f[2].lowOrder,f[3].highOrder,f[3].lowOrder,f[4].highOrder,f[4].lowOrder,f[5].highOrder,f[5].lowOrder,f[6].highOrder,f[6].lowOrder,f[7].highOrder,f[7].lowOrder];default:return[]}},jsSHA=function(r,i){this.sha1=null;this.sha224=null;this.sha256=null;this.sha384=null;this.sha512=null;this.strBinLen=null;this.strToHash=null;if("HEX"===i){if(0!==r.length%2){return"TEXT MUST BE IN BYTE INCREMENTS"}this.strBinLen=r.length*4;this.strToHash=hex2binb(r)}else if("ASCII"===i||"undefined"===typeof i){this.strBinLen=r.length*charSize;this.strToHash=str2binb(r)}else{return"UNKNOWN TEXT INPUT TYPE"}};jsSHA.prototype={getHash:function(r,i){var e=null,t=this.strToHash.slice();switch(i){case"HEX":e=binb2hex;break;case"B64":e=binb2b64;break;default:return"FORMAT NOT RECOGNIZED"}switch(r){case"SHA-1":if(null===this.sha1){this.sha1=coreSHA1(t,this.strBinLen)}return e(this.sha1);case"SHA-224":if(null===this.sha224){this.sha224=coreSHA2(t,this.strBinLen,r)}return e(this.sha224);case"SHA-256":if(null===this.sha256){this.sha256=coreSHA2(t,this.strBinLen,r)}return e(this.sha256);case"SHA-384":if(null===this.sha384){this.sha384=coreSHA2(t,this.strBinLen,r)}return e(this.sha384);case"SHA-512":if(null===this.sha512){this.sha512=coreSHA2(t,this.strBinLen,r)}return e(this.sha512);default:return"HASH NOT RECOGNIZED"}},getHMAC:function(r,i,e,t){var n,a,o,s,d,h,g,u,l,f=[],c=[];switch(t){case"HEX":n=binb2hex;break;case"B64":n=binb2b64;break;default:return"FORMAT NOT RECOGNIZED"}switch(e){case"SHA-1":o=64;l=160;break;case"SHA-224":o=64;l=224;break;case"SHA-256":o=64;l=256;break;case"SHA-384":o=128;l=384;break;case"SHA-512":o=128;l=512;break;default:return"HASH NOT RECOGNIZED"}if("HEX"===i){if(0!==r.length%2){return"KEY MUST BE IN BYTE INCREMENTS"}a=hex2binb(r);u=r.length*4}else if("ASCII"===i){a=str2binb(r);u=r.length*charSize}else{return"UNKNOWN KEY INPUT TYPE"}s=o*8;g=o/4-1;if(o<u/8){if("SHA-1"===e){a=coreSHA1(a,u)}else{a=coreSHA2(a,u,e)}a[g]&=4294967040}else if(o>u/8){a[g]&=4294967040}for(d=0;d<=g;d+=1){f[d]=a[d]^909522486;c[d]=a[d]^1549556828}if("SHA-1"===e){h=coreSHA1(f.concat(this.strToHash),s+this.strBinLen);h=coreSHA1(c.concat(h),s+l)}else{h=coreSHA2(f.concat(this.strToHash),s+this.strBinLen,e);h=coreSHA2(c.concat(h),s+l,e)}return n(h)}};window.jsSHA=jsSHA;