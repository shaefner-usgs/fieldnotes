<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset=utf-8>
	<title></title>
	<style>
		input {
			padding: 40px 20px;
		}
		canvas {
			border: 1px solid black;
		}
	</style>
	<script src="lib/exif.js"></script>
	<script src="lib/megapix-image.js"></script>
	<script charset="utf-8">

// read file and render it to canvas
function loadImage(file) {
	//	Prevent any non-image file type from being read.
	if (!file.type.match(/image.*/)) {
		return;
	}

	// use library to read and render img - overcomes iOS resolution limitation and makes rotating / resizing easy
	// https://github.com/stomita/ios-imagefile-megapixel
	var mpImg = new MegaPixImage(file),
		MAX_SIZE = 800,
		canvas = document.getElementById('canvas');

	// Get img orientation, then render to canvas elem
	EXIF.getData(file, function() {
		var orientation = EXIF.getTag(this, 'Orientation');
		mpImg.render(canvas, { maxWidth: MAX_SIZE, maxHeight: MAX_SIZE, orientation: orientation });
		upload();
	});
}

function upload() {
	// grab contents of canvas element (resized img)
	var img = document.getElementById('canvas').toDataURL('image/png');
	var upload = encodeURIComponent(img);
}

window.onload = function() {
	var target = document.getElementById('photo');
	target.addEventListener('change', function(e) {
		var file = e.target.files[0]; // file pointer obj
		loadImage(file);
	});
}

	</script>
</head>
<body>

	<form action="">
		<input type="file" name="photo" id="photo" accept="image/*">	
	</form>
	<canvas id="canvas"></canvas>

</body>
</html>
